

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation &mdash; Horizon 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Usage" href="usage.html" />
    <link rel="prev" title="ReAgent: Applied Reinforcement Learning Platform" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Horizon
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#anaconda">Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="distributed.html">Distributed Training</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/ml.rl.workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/ml.rl.preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/ml.rl.simulators.html">Simulators</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/ml.rl.thrift.html">Thrift</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/ml.rl.training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">All Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Others</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/facebookresearch/ReAgent">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Horizon</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<span id="id1"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="anaconda">
<h2>Anaconda<a class="headerlink" href="#anaconda" title="Permalink to this headline">¶</a></h2>
<p>First, install anaconda from here (make sure to pick the python 3 version): <a class="reference external" href="https://www.anaconda.com/">Website</a>.</p>
<p>Next, we’re going to add some channels that we need for certain software:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="c1"># For ONNX/tensorboardX</span>
<span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">pytorch</span> <span class="c1"># For PyTorch</span>
</pre></div>
</div>
<p>Clone and enter Horizon repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">facebookresearch</span><span class="o">/</span><span class="n">Horizon</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">Horizon</span><span class="o">/</span>
</pre></div>
</div>
<p>Install dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">--</span><span class="n">file</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Install ONNX using pip, which builds the latest version from source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">onnx</span>
</pre></div>
</div>
<p>Set JAVA_HOME to the location of your anaconda install</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export JAVA_HOME=&quot;$(dirname $(dirname -- `which conda`))&quot;

echo $JAVA_HOME # Should see something like &quot;/home/jjg/miniconda3&quot;
</pre></div>
</div>
<p>Install Spark (the mv command may need to be done as root):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">archive</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">dist</span><span class="o">/</span><span class="n">spark</span><span class="o">/</span><span class="n">spark</span><span class="o">-</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">spark</span><span class="o">-</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="nb">bin</span><span class="o">-</span><span class="n">hadoop2</span><span class="o">.</span><span class="mf">7.</span><span class="n">tgz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xzf</span> <span class="n">spark</span><span class="o">-</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="nb">bin</span><span class="o">-</span><span class="n">hadoop2</span><span class="o">.</span><span class="mf">7.</span><span class="n">tgz</span>
<span class="n">sudo</span> <span class="n">mv</span> <span class="n">spark</span><span class="o">-</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="nb">bin</span><span class="o">-</span><span class="n">hadoop2</span><span class="o">.</span><span class="mi">7</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">spark</span>
</pre></div>
</div>
<p>Add the spark bin directory to your path so your terminal can find <code class="docutils literal notranslate"><span class="pre">spark-submit</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=$PATH:/usr/local/spark/bin
</pre></div>
</div>
<p>Install OpenAI Gym if you plan on following our <a class="reference external" href="usage.md">tutorial</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="s2">&quot;gym[classic_control,box2d,atari]&quot;</span>
</pre></div>
</div>
<p>We use Apache Thrift to generate container classes and handle serialization to/from JSON.  To build our thrift classes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thrift</span> <span class="o">--</span><span class="n">gen</span> <span class="n">py</span> <span class="o">--</span><span class="n">out</span> <span class="o">.</span> <span class="n">ml</span><span class="o">/</span><span class="n">rl</span><span class="o">/</span><span class="n">thrift</span><span class="o">/</span><span class="n">core</span><span class="o">.</span><span class="n">thrift</span>
</pre></div>
</div>
<p>And now, you are ready to install Horizon itself.  We use “-e” to create an ephemral package.  This means that you can make changes to Horizon and they will be reflected in the package immediately.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>At this point, you should be able to run all unit tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span>
</pre></div>
</div>
</div>
<div class="section" id="docker">
<h2>Docker<a class="headerlink" href="#docker" title="Permalink to this headline">¶</a></h2>
<p>We have included a Dockerfile for the CPU-only build and CUDA build under the docker directory.
The CUDA build will need <a class="reference external" href="https://github.com/NVIDIA/nvidia-docker">nvidia-docker</a> to run.</p>
<p>To build, clone repository and cd into the respective directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">facebookresearch</span><span class="o">/</span><span class="n">Horizon</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">Horizon</span><span class="o">/</span>
</pre></div>
</div>
<p>On macOS you will need to increase the default memory allocation as the default of 2G is not enough. You can do this by clicking the whale icon in the task bar. We recommend using at least 8G of memory.</p>
<p>On macOS, you can then build the image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">f</span> <span class="n">docker</span><span class="o">/</span><span class="n">cpu</span><span class="o">.</span><span class="n">Dockerfile</span> <span class="o">-</span><span class="n">t</span> <span class="n">horizon</span><span class="p">:</span><span class="n">dev</span> <span class="o">.</span>
</pre></div>
</div>
<p>On Linux you can build the image with specific memory allocations from command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">f</span> <span class="n">docker</span><span class="o">/</span><span class="n">cpu</span><span class="o">.</span><span class="n">Dockerfile</span> <span class="o">-</span><span class="n">t</span> <span class="n">horizon</span><span class="p">:</span><span class="n">dev</span> <span class="o">--</span><span class="n">memory</span><span class="o">=</span><span class="mi">8</span><span class="n">g</span> <span class="o">--</span><span class="n">memory</span><span class="o">-</span><span class="n">swap</span><span class="o">=</span><span class="mi">8</span><span class="n">g</span> <span class="o">.</span>
</pre></div>
</div>
<p>To build with CUDA support, use the corresponding dockerfile:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">f</span> <span class="n">docker</span><span class="o">/</span><span class="n">cuda</span><span class="o">.</span><span class="n">Dockerfile</span> <span class="o">-</span><span class="n">t</span> <span class="n">horizon</span><span class="p">:</span><span class="n">dev</span> <span class="o">.</span>
</pre></div>
</div>
<p>Once the Docker image is built you can start an interactive shell in the container and run the unit tests. To have the ability to edit files locally and have changes be available in the Docker container, mount the local Horizon repo as a volume using the <code class="docutils literal notranslate"><span class="pre">-v</span></code> flag. We also add <code class="docutils literal notranslate"><span class="pre">-p</span></code> for port mapping so we can view Tensorboard visualizations locally.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -v $PWD:/home/Horizon -p 0.0.0.0:6006:6006 -it horizon:dev
</pre></div>
</div>
<p>To run with GPU, include <code class="docutils literal notranslate"><span class="pre">--runtime=nvidia</span></code> after installing <a class="reference external" href="https://github.com/NVIDIA/nvidia-docker">nvidia-docker</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run --runtime=nvidia -v $PWD:/home/Horizon -p 0.0.0.0:6006:6006 -it horizon:dev
</pre></div>
</div>
<p>If you have SELinux (Fedora, Redhat, etc.) you will have to start docker with the following command (notice the <code class="docutils literal notranslate"><span class="pre">:Z</span></code> at the end of path):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -v $PWD:/home/Horizon:Z -p 0.0.0.0:6006:6006 -it horizon:dev
</pre></div>
</div>
<p>To run with GPU, include <code class="docutils literal notranslate"><span class="pre">--runtime=nvidia</span></code> after installing <a class="reference external" href="https://github.com/NVIDIA/nvidia-docker">nvidia-docker</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run --runtime=nvidia -v $PWD:/home/Horizon:Z -p 0.0.0.0:6006:6006 -it horizon:dev
</pre></div>
</div>
<p>Depending on where your local Horizon copy is, you may need to white list your shared path via Docker -&gt; Preferences… -&gt; File Sharing.</p>
<p>Once inside the container, run the setup file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">Horizon</span>
<span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Now you can run all the tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test</span>
</pre></div>
</div>
<p>or try running one specific test:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">test</span> <span class="o">-</span><span class="n">s</span> <span class="n">ml</span><span class="o">.</span><span class="n">rl</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">constant_reward</span><span class="o">.</span><span class="n">test_constant_reward</span><span class="o">.</span><span class="n">TestConstantReward</span><span class="o">.</span><span class="n">test_trainer_maxq</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="usage.html" class="btn btn-neutral float-right" title="Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="ReAgent: Applied Reinforcement Learning Platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Facebook Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>